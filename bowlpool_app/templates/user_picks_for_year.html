{% extends 'base.html' %}

{% block content %}
  <h2>Your Picks</h2>

  {% load tz %}

  <form action="{% url 'submit_my_picks_for_year' bowl_year %}" method="post">
    {% csrf_token %}

    <table class="table table-striped table-hover">
      <thead>
      <tr>
        <th scope="col">Bowl Name</th>
        <th scope="col">Start Date/Time (Central)</th>
        <th scope="col">Away Team</th>
        <th scope="col">Home Team</th>
        <th scope="col">Favorite</th>
        <th scope="col">Your Pick</th>
      </tr>
      </thead>

      <tbody>
      {% timezone "America/Chicago" %}
        {% for bowl_matchup_pick in picks_for_year %}
          <tr>
            <td>
              {{ bowl_matchup_pick.bowl_matchup.bowl_game }}
              {% if bowl_matchup_pick.bowl_matchup.cfp_playoff_game %}
              (CFP Semifinal)
              {% endif %}
            </td>
            <td>{{ bowl_matchup_pick.bowl_matchup.start_time }}</td>
            <td>
              {% if bowl_matchup_pick.bowl_matchup.away_team %}
                {{ bowl_matchup_pick.bowl_matchup.away_team.name }}
              {% else %}
                ?
              {% endif %}
            </td>
            <td>
              {% if bowl_matchup_pick.bowl_matchup.home_team %}
                {{ bowl_matchup_pick.bowl_matchup.home_team.name }}
              {% else %}
                ?
              {% endif %}
            </td>
            <td>{{ bowl_matchup_pick.bowl_matchup.bowl_favorite }}</td>
            <td>
              <select name="{{ bowl_matchup_pick.bowl_matchup.id }}-winner">
                <option value=""></option>
                {% if bowl_matchup_pick.bowl_matchup.bowl_game.name != "CFP National Championship" %}
                <option value="{{ bowl_matchup_pick.bowl_matchup.away_team.id }}"
                  {% if bowl_matchup_pick.winner.id == bowl_matchup_pick.bowl_matchup.away_team.id %}
                  selected="selected"
                  {% endif %}
                >
                  {{ bowl_matchup_pick.bowl_matchup.away_team.name }}
                </option>
                <option value="{{ bowl_matchup_pick.bowl_matchup.home_team.id }}"
                  {% if bowl_matchup_pick.winner.id == bowl_matchup_pick.bowl_matchup.home_team.id %}
                  selected="selected"
                  {% endif %}
                >
                  {{ bowl_matchup_pick.bowl_matchup.home_team.name }}
                </option>
                {% else %}
                  {% for team in cfp_teams %}
                  <option value="{{ team.id }}"
                    {% if bowl_matchup_pick.winner.id == team.id %}
                    selected="selected"
                    {% endif %}
                  >
                    {{ team.name }}
                  </option>
                  {% endfor %}
                {% endif %}
              </select>
              by
              <input type="number" name="{{ bowl_matchup_pick.bowl_matchup.id }}-margin"
              value="{{ bowl_matchup_pick.margin }}">
            </td>
          </tr>
        {% endfor %}
      {% endtimezone %}
      </tbody>
    </table>

    <input type="submit" value="Submit Picks">
  </form>
{% endblock %}